 <div class="p-4">
      <!-- Filtros de Data -->
      <mat-card class="mb-4">
        <mat-card-content>
          <form [formGroup]="filterForm" class="flex gap-4">
            <mat-form-field>
              <mat-label>Data Inicial</mat-label>
              <input matInput [matDatepicker]="startPicker" formControlName="startDate">
              <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
              <mat-datepicker #startPicker></mat-datepicker>
            </mat-form-field>

            <mat-form-field>
              <mat-label>Data Final</mat-label>
              <input matInput [matDatepicker]="endPicker" formControlName="endDate">
              <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
              <mat-datepicker #endPicker></mat-datepicker>
            </mat-form-field>

            <button mat-raised-button color="primary" (click)="applyFilters()">
              Aplicar Filtros
            </button>

            <button mat-stroked-button (click)="exportReport()">
              <mat-icon>download</mat-icon>
              Exportar Relatório
            </button>
          </form>
        </mat-card-content>
      </mat-card>

      <!-- Cards de Métricas -->
      <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
        <mat-card>
          <mat-card-content>
            <div class="text-center">
              <div class="text-2xl font-bold">{{analytics?.visualizacoes || 0}}</div>
              <div class="text-gray-600">Visualizações</div>
              <div class="text-sm text-green-600" *ngIf="analytics?.crescimentoVisualizacoes">
                +{{analytics?.crescimentoVisualizacoes}}% vs último período
              </div>
            </div>
          </mat-card-content>
        </mat-card>

        <mat-card>
          <mat-card-content>
            <div class="text-center">
              <div class="text-2xl font-bold">{{analytics?.alunosAtivos || 0}}</div>
              <div class="text-gray-600">Alunos Ativos</div>
              <div class="text-sm" [ngClass]="{'text-green-600': analytics?.crescimentoAlunos > 0, 'text-red-600': analytics?.crescimentoAlunos < 0}">
                {{analytics?.crescimentoAlunos > 0 ? '+' : ''}}{{analytics?.crescimentoAlunos}}% vs último período
              </div>
            </div>
          </mat-card-content>
        </mat-card>

        <mat-card>
          <mat-card-content>
            <div class="text-center">
              <div class="text-2xl font-bold">{{analytics?.avaliacaoMedia?.toFixed(1) || 0}}</div>
              <div class="text-gray-600">Avaliação Média</div>
              <div class="text-sm">
                {{analytics?.totalAvaliacoes || 0}} avaliações
              </div>
            </div>
          </mat-card-content>
        </mat-card>

        <mat-card>
          <mat-card-content>
            <div class="text-center">
              <div class="text-2xl font-bold">{{analytics?.taxaConclusao?.toFixed(1) || 0}}%</div>
              <div class="text-gray-600">Taxa de Conclusão</div>
              <div class="text-sm">
                {{analytics?.alunosConcluintes || 0}} alunos concluintes
              </div>
            </div>
          </mat-card-content>
        </mat-card>
      </div>

      <!-- Gráficos -->
      <mat-tabs>
        <!-- Engajamento por Aula -->
        <mat-tab label="Engajamento por Aula">
          <div class="p-4">
            <mat-card>
              <mat-card-content>
                <canvas baseChart
                  [datasets]="engagementChartData"
                  [labels]="engagementChartLabels"
                  [options]="chartOptions"
                  type="bar">
                </canvas>
              </mat-card-content>
            </mat-card>
          </div>
        </mat-tab>

        <!-- Progresso dos Alunos -->
        <mat-tab label="Progresso dos Alunos">
          <div class="p-4">
            <mat-card>
              <mat-card-content>
                <canvas baseChart
                  [datasets]="progressChartData"
                  [labels]="progressChartLabels"
                  [options]="chartOptions"
                  type="line">
                </canvas>
              </mat-card-content>
            </mat-card>
          </div>
        </mat-tab>

        <!-- Receita -->
        <mat-tab label="Análise de Receita">
          <div class="p-4">
            <mat-card>
              <mat-card-content>
                <canvas baseChart
                  [datasets]="revenueChartData"
                  [labels]="revenueChartLabels"
                  [options]="chartOptions"
                  type="line">
                </canvas>
              </mat-card-content>
            </mat-card>
          </div>
        </mat-tab>
      </mat-tabs>

      <!-- Tabela de Engajamento por Conteúdo -->
      <mat-card class="mt-6">
        <mat-card-header>
          <mat-card-title>Engajamento por Conteúdo</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <table class="w-full">
            <thead>
              <tr>
                <th class="text-left p-2">Conteúdo</th>
                <th class="text-center p-2">Visualizações</th>
                <th class="text-center p-2">Tempo Médio</th>
                <th class="text-center p-2">Taxa de Conclusão</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of analytics?.engajamentoPorAula">
                <td class="p-2">{{item.titulo}}</td>
                <td class="text-center p-2">{{item.visualizacoes}}</td>
                <td class="text-center p-2">{{item.tempoMedio}} min</td>
                <td class="text-center p-2">{{item.taxaConclusao}}%</td>
              </tr>
            </tbody>
          </table>
        </mat-card-content>
      </mat-card>
    </div>
